<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coding.gugu.BoardMapper">
	<insert 
		id="create" 
	>
	<selectKey keyProperty="bno" order="BEFORE" resultType="int">
		SELECT SEQ_TBL_BOARD.NEXTVAL FROM DUAL
	</selectKey>
		INSERT INTO TBL_BOARD (BNO , TITLE, CONTENT , WRITER)
		VALUES ( #{bno}, #{title}, #{content}, #{writer} )
	</insert>

	<select 
		id="read" resultType="boardVO"
	>
		SELECT BNO, TITLE, CONTENT, WRITER, REGDATE, VIEWCNT
		FROM TBL_BOARD
		WHERE BNO = #{bno}
	</select>
	
	<update
		id="update" 
	>
		UPDATE TBL_BOARD SET CONTENT = #{content}, TITLE = #{title}  WHERE BNO = #{bno}
	</update>
	
	<delete 
		id="delete"
	>
		DELETE FROM TBL_BOARD WHERE BNO = #{bno}
	</delete>
	
	<select 
		id="listPage" resultType="boardVO" parameterType="boardVO"
	>
	<![CDATA[
		SELECT
			BNO AS bno
			, TITLE AS title
			, CONTENT AS content
			, WRITER AS writer
			, REGDATE AS regdate
			, VIEWCNT AS viewcnt
		FROM
			(
				SELECT
					Y.*
				FROM
					(
						SELECT
							ROWNUM RN, X.*
						FROM
							(
								SELECT
									TB.BNO, TB.TITLE, TB.CONTENT, TB.WRITER, TB.REGDATE, TB.VIEWCNT
								FROM
									TBL_BOARD TB
								ORDER BY
									TB.BNO DESC
							) X
						WHERE
							ROWNUM <= ${rowEnd}
					) Y
				WHERE
					Y.RN > ${rowStart}
			) Z
	]]>
	</select>
	
	<select 
		id="listCnt" resultType="Long" parameterType="boardVO"
	>
	<![CDATA[
		SELECT
			COUNT(1)
		FROM
			TBL_BOARD TB
		ORDER BY
			TB.BNO DESC
	]]>
	</select>

</mapper>